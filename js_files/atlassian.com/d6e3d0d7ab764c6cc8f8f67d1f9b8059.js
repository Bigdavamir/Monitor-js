(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([["copy-heading-link"],{431:function(e,t,n){},457:function(e,t,n){"use strict";n.r(t),n.d(t,"addButtonClickListener",(function(){return b})),n.d(t,"appendIconsToButton",(function(){return y})),n.d(t,"hasAllowedHtmlNodes",(function(){return g})),n.d(t,"addHideButtonDuringCopyListener",(function(){return k}));var o=n(6),i=n(127),c=n.n(i),a=n(74),l=n.n(a),d=(n(431),n(128)),r=n(23),s=n(97);function u(){Object(s.trigger)("analyticsEvent",{name:"confluence.copy-heading-link.copy-to-clipboard-failure"})}var h=n(35);function p(e){const t=document.createElement("textarea");t.innerText=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){throw console.warn("confluence/clipboard-helper: Failed to copy link (using document.execCommand('copy')).",e),e}finally{document.body.removeChild(t)}}function f(e){var t;const n=window.isSecureContext&&(null===(t=window.navigator)||void 0===t?void 0:t.clipboard);n?n.writeText(e).catch(t=>{console.warn("confluence/clipboard-helper-ts: Failed to copy link (using clipboard.writeText), trying fallback copy method.",t),p(e)}):p(e)}function m(e,t){setTimeout(()=>{t.classList.add(e);const n=$(t);n.tooltip("show"),["mouseleave","focusout"].forEach(o=>{const i=()=>{t.classList.remove(e),n.tooltip("hide"),r.document.activeElement instanceof HTMLElement&&r.document.activeElement===t&&r.document.activeElement.blur(),t.removeEventListener("mouseleave",i),t.removeEventListener("focusout",i)};t.addEventListener(o,i)}),setTimeout(()=>{t.classList.contains(e)&&n.tooltip("show")},301)},0)}function y(e,t,n){const o=r.document.createElement("span");o.classList.add("aui-icon","aui-iconfont-"+t,"copy-heading-link-img"),o.role="img",o.ariaLabel=n,e.appendChild(o)}function g(e){const t=["BR","A","SPAN","STRONG","B","EM","I","U","DEL","S","IMG"],n=Array.from(e.childNodes);let o=Array.from(e.childNodes);n.forEach(e=>{e.childNodes.length>0&&(o=o.concat(Array.from(e.childNodes)))});return o.every(e=>{if(e.nodeType===Node.ELEMENT_NODE){const n=e;if(!t.includes(n.tagName))return!1;if("IMG"===n.tagName&&!n.classList.contains("emoticon"))return!1}else if(e.nodeType!==Node.TEXT_NODE)return!1;return!0})}function b(e){e.addEventListener("click",e=>{var t;const n=e.target.closest(".copy-heading-link-button");if(!(n&&n instanceof HTMLElement&&n.dataset.headingId))return;let o=null===(t=r.document.querySelector("#title-text a"))||void 0===t?void 0:t.href;if(o||(o=l.a.get("base-url")),n.dataset.headingId)try{o+="#"+encodeURIComponent(n.dataset.headingId)}catch(e){return console.warn("Error encoding heading ID: ",e),u(),void m("copy-link-fail",n)}try{f(o)}catch(e){return console.warn("Error copying link: ",e),u(),void m("copy-link-fail",n)}Object(s.trigger)("analyticsEvent",{name:"confluence.copy-heading-link.copy-to-clipboard-success"}),m("copy-link-success",n)})}function k(e){e.addEventListener("copy",()=>{const e=window.getSelection();if(!e||0===e.rangeCount)return;const t=e.getRangeAt(0).cloneRange().cloneContents().querySelectorAll(".copy-heading-link-button");t.forEach(e=>{const t=r.document.querySelector(`[data-heading-id="${e.dataset.headingId}"]`);t&&(t.style.display="none")}),setTimeout(()=>{t.forEach(e=>{const t=r.document.querySelector(`[data-heading-id="${e.dataset.headingId}"]`);t&&(t.style.display="")})},0)})}Object(h.a)("confluence/clipboard-helper-ts",()=>({copyToClipboard:f})),Object(d.a)().then(()=>{if(c.a.isEnabled("confluence.copy-heading-link")){const e=r.document.querySelector("#main-content.wiki-content");if(!e)return;e.querySelectorAll(":is(h1, h2, h3, h4, h5, h6):not(table h1, table h2, table h3, table h4, table h5, table h6)").forEach(e=>{if(!g(e)||!e.id)return;const t=r.document.createElement("button");t.classList.add("copy-heading-link-button"),t.setAttribute("aria-label","Copy link to heading"),t.dataset.headingId=e.id,$(t).tooltip({title(){return this.classList.contains("copy-link-success")?this.querySelector(".aui-iconfont-approve").getAttribute("aria-label"):this.classList.contains("copy-link-fail")?this.querySelector(".aui-iconfont-cross-circle").getAttribute("aria-label"):this.getAttribute("aria-label")},gravity:"s"}),y(t,"link","Copy link to heading"),y(t,"approve","Copied!"),y(t,"cross-circle","Error copying link");const n=r.document.createElement("span");n.classList.add("copy-heading-link-container"),n.appendChild(t),e.appendChild(n)}),b(e),k(e)}})}},[[457,"manifest","vendors~backbone~color-scheme~copy-heading-link~date-time~deprecated-dialog~form-state-control~inlin~b2589942","vendors~backbone~copy-heading-link~date-time~deprecated-dialog~form-state-control~inline-dialog~jque~28f2adbc","vendors~benefits~color-scheme~copy-heading-link~date-time~skip-links~table-styles-editor~theme-switc~8335ef94","vendors~color-scheme~copy-heading-link","copy-heading-link~date-time~deprecated-dialog~form-state-control~inline-dialog~locale~skip-links~tab~827d69cb","benefits~color-scheme~copy-heading-link~date-time~skip-links~table-styles-editor~theme-switcher~them~0355ead0","benefits~color-scheme~copy-heading-link~date-time~skip-links~table-styles-editor~theme-switcher-loader","copy-heading-link~render-benefits-modal~theme-switcher~theme-switcher-loader","benefits~copy-heading-link~date-time~locale","benefits~copy-heading-link"]]]);