require(["ajs","jquery"],function(f,b){f.toInit(function(){var c=b("#sv-dropdown-link");if(c.length){var g=c.parent();c.detach();c.attr({"aria-owns":"sv-dropdown-menu","aria-haspopup":"true"});c.addClass("aui-dropdown2-trigger aui-dropdown2-trigger-arrowless");c.find("span").addClass("sv-dropdown-icon");c.append(Scroll.Versions.Dropdown.Templates.dropdown({versionMgmtEnabled:Scroll.Versions.Context.modules.VersionManagement.isEnabledInSpace,variantMgmtEnabled:Scroll.Versions.Context.modules.VariantManagement.isEnabledInSpace,
numberOfVersionsInSpace:Scroll.Versions.Context.space.getVersions().length,isNonMatchingVersion:Scroll.Versions.Context.page.isNonMatchingVersion,isLastVersion:Scroll.Versions.Context.page.isLastVersion,isUnversionedPage:Scroll.Versions.Context.page.isUnversionedPage,hasEditRestrictionForVersion:Scroll.Versions.Context.user.hasEditRestrictionForVersion,isPageKeyUnset:""==Scroll.Versions.Context.page.scrollPageKey,manageContent:Scroll.Versions.Context.user.permissions.ManageContent,contribute:Scroll.Versions.Context.user.permissions.Contribute,
isReadOnlyMode:Scroll.Versions.AJS.isReadOnlyModeEnabled()}));g.append(c);b("#sv-dropdown-menu").on({"aui-dropdown2-show":function(){b(this).css("left",c.offset().left+c.outerWidth()-b(this).width()-2+"px")}});var d=function(a,h){Scroll.Versions.loadPageContextApp().then(function(k){k.DialogManager[a](h);b("#sv-dropdown-menu").is(":visible")&&c.trigger("aui-button-invoke")})},e=Scroll.Versions.Context.page.targetVersion;b("#sv-dropdown-reschedule:not(.sv-link-disabled)").click(function(a){a.preventDefault();
d("openRescheduleDialog",e)});b("#sv-dropdown-convertToUnversioned:not(.sv-link-disabled)").click(function(a){a.preventDefault();d("openConvertToUnversionedPageDialog",e)});b("#sv-dropdown-convertToVersioned:not(.sv-link-disabled)").click(function(a){a.preventDefault();d("openConvertToVersionedPageDialog",Scroll.Versions.Context.user.workingVersion)});b("#sv-dropdown-delete:not(.sv-link-disabled)").click(function(a){a.preventDefault();d("openDeleteVersionDialog",e)});b("#sv-dropdown-pageversions:not(.sv-link-disabled)").click(function(a){a.preventDefault();
d("openVersionsDialog")});b("#sv-dropdown-attributes:not(.sv-link-disabled)").click(function(a){a.preventDefault();d("openAttributesDialog")});b("#sv-dropdown-properties:not(.sv-link-disabled)").click(function(a){a.preventDefault();d("openContentPropertiesDialog")});b("#sv-dropdown-add-pagekey:not(.sv-link-disabled)").click(function(a){a.preventDefault();d("openPageKeyDialog")})}})});